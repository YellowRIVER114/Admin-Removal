# Define the authorized administrators list $authorizedAdministrators = @( "ashepard", "ygagarin", "vkomarov", "jglenn", "vtereshkova", "gcooper" ) # Get all members of the Administrators group $administrators = Get-LocalGroupMember -Group "Administrators" foreach ($admin in $administrators) { $username = $admin.Name if ($authorizedAdministrators -notcontains $username) { try { # Check if the user is not in the authorized list before removing if ($username -ne $env:USERNAME) { # Ensures current user (you) is not removed Remove-LocalGroupMember -Group "Administrators" -Member $username -ErrorAction Stop Write-Host "Removed unauthorized user '$username' from Administrators group." } else { Write-Host "Skipping removal of current user '$username'." -ForegroundColor Yellow } } catch { Write-Host "Failed to remove unauthorized user '$username' from Administrators group. Error: $_" -ForegroundColor Red } } }
